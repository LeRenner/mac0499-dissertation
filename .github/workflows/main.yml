name: Create and release document PDF

on:
  push:
    branches:
    - main

jobs:
  push_to_registry:
    name: Build and release PDF
    runs-on: ubuntu-latest
    steps:
          
      - name: Check out the repo
        uses: actions/checkout@v3
      
      - name: Build LaTeX PDF
        uses: docker://lerenner/build-latex-pdf:main

      - uses: actions/upload-artifact@v4
        with:
          name: dissertation-pdf
          path: tese.pdf

      - name: executing remote ssh commands using password
        uses: appleboy/ssh-action@v1.0.3
        with:
          host: ${{ secrets.SSH_HOSTNAME }}
          username: ${{ secrets.SSH_USERNAME }}
          password: ${{ secrets.SSH_PASSWORD }}
          port: 22
          script: "cd /home/bmac/renner/www/MAC0499 && wget ${{ steps.artifact-upload-step.outputs.artifact-url }} && rm -f tese.pdf && unzip dissertation-pdf.zip && rm dissertation-pdf.zip"
